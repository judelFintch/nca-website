let m=0;const Y=document.querySelectorAll(".hero-slide"),Q=document.querySelectorAll(".slider-dot"),w=Y.length;function x(e){Y.forEach((t,s)=>{t.classList.toggle("active",s===e)}),Q.forEach((t,s)=>{t.classList.toggle("active",s===e)})}function M(){m=(m+1)%w,x(m)}function re(){m=(m-1+w)%w,x(m)}document.getElementById("next-slide").addEventListener("click",M);document.getElementById("prev-slide").addEventListener("click",re);Q.forEach((e,t)=>{e.addEventListener("click",()=>{m=t,x(m)})});let J=setInterval(M,6e3);const W=document.querySelector(".hero");W.addEventListener("mouseenter",()=>{clearInterval(J)});W.addEventListener("mouseleave",()=>{J=setInterval(M,6e3)});const de=document.getElementById("theme-toggle"),B=document.documentElement,U=document.querySelector(".light-icon"),X=document.querySelector(".dark-icon"),ue=localStorage.getItem("theme")||"light";ue==="dark"&&(B.classList.add("dark"),U.style.display="none",X.style.display="block");de.addEventListener("click",()=>{B.classList.toggle("dark");const e=B.classList.contains("dark");U.style.display=e?"none":"block",X.style.display=e?"block":"none",localStorage.setItem("theme",e?"dark":"light")});const g=document.getElementById("mobile-menu-btn"),v=document.getElementById("mobile-menu"),me=document.querySelectorAll(".mobile-link");g.addEventListener("click",()=>{const e=v.classList.contains("active");v.classList.toggle("active");const t=g.querySelector("i");t.className=e?"fas fa-bars":"fas fa-times"});me.forEach(e=>{e.addEventListener("click",()=>{v.classList.remove("active");const t=g.querySelector("i");t.className="fas fa-bars"})});document.addEventListener("click",e=>{if(!v.contains(e.target)&&!g.contains(e.target)){v.classList.remove("active");const t=g.querySelector("i");t.className="fas fa-bars"}});document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();const s=document.querySelector(this.getAttribute("href"));if(s){const n=s.offsetTop-80;window.scrollTo({top:n,behavior:"smooth"})}})});const ve={threshold:.1,rootMargin:"0px 0px -50px 0px"},ge=new IntersectionObserver(e=>{e.forEach(t=>{t.isIntersecting&&t.target.classList.add("animate")})},ve);document.querySelectorAll(".animate-on-scroll").forEach(e=>{ge.observe(e)});const F=document.getElementById("navbar");window.addEventListener("scroll",()=>{window.scrollY>100?F.classList.add("scrolled"):F.classList.remove("scrolled")});document.getElementById("contact-form").addEventListener("submit",function(e){e.preventDefault();const t=this.querySelector('button[type="submit"]'),s=t.innerHTML;t.innerHTML='<i class="fas fa-spinner fa-spin"></i> Envoi en cours...',t.disabled=!0,t.style.background="var(--gray-400)",setTimeout(()=>{t.innerHTML='<i class="fas fa-check"></i> Message envoyé !',t.style.background="var(--success)",setTimeout(()=>{alert("Merci pour votre demande ! Notre équipe vous contactera dans les plus brefs délais."),this.reset(),t.innerHTML=s,t.disabled=!1,t.style.background=""},1e3)},2e3)});function fe(){document.querySelectorAll(".stat-number").forEach(t=>{const s=t.textContent;if(!isNaN(s.replace("+","").replace("%",""))){const o=parseInt(s.replace(/\D/g,"")),l=o/100;let f=0;const le=setInterval(()=>{f+=l,f>=o?(t.textContent=s,clearInterval(le)):t.textContent=Math.floor(f)+(s.includes("+")?"+":s.includes("%")?"%":"")},20)}})}const P=document.querySelector(".stats-section");if(P){const e=new IntersectionObserver(t=>{t.forEach(s=>{s.isIntersecting&&(fe(),e.unobserve(s.target))})},{threshold:.5});e.observe(P)}document.addEventListener("keydown",e=>{if(e.key==="Escape"&&v.classList.contains("active")){v.classList.remove("active");const t=g.querySelector("i");t.className="fas fa-bars"}});document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>{document.body.style.opacity="1"},100)});x(0);const G=document.querySelectorAll(".gallery-item");let i=null;function ye(){i=document.createElement("div"),i.className="lightbox",i.innerHTML=`
<div class="lightbox-content">
<button class="lightbox-close">
    <i class="fas fa-times"></i>
</button>
<div id="lightbox-image"></div>
</div>
`,document.body.appendChild(i),i.querySelector(".lightbox-close").addEventListener("click",T),i.addEventListener("click",e=>{e.target===i&&T()})}function pe(e){i||ye();const t=i.querySelector("#lightbox-image"),n=document.querySelector(`[data-image="${e}"]`).querySelector("svg").cloneNode(!0);n.style.width="100%",n.style.height="auto",n.style.maxWidth="800px",n.style.maxHeight="600px",t.innerHTML="",t.appendChild(n),i.classList.add("active"),document.body.style.overflow="hidden"}function T(){i&&(i.classList.remove("active"),document.body.style.overflow="")}G.forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.image;pe(t)})});document.addEventListener("keydown",e=>{e.key==="Escape"&&i&&i.classList.contains("active")&&T()});let p=0;const V=document.getElementById("testimonials-track"),N=document.querySelectorAll(".testimonial-dot"),he=N.length;function K(e){V&&(V.style.transform=`translateX(-${e*100}%)`,N.forEach((t,s)=>{t.classList.toggle("active",s===e)}))}function be(){p=(p+1)%he,K(p)}N.forEach((e,t)=>{e.addEventListener("click",()=>{p=t,K(p)})});setInterval(be,8e3);const _=document.querySelectorAll(".blog-card");_.forEach((e,t)=>{e.style.animationDelay=`${t*.2}s`});const I=document.getElementById("faq-search"),q=document.querySelectorAll(".faq-item"),S=document.querySelectorAll(".faq-category"),Ee=document.querySelectorAll(".faq-question");function Le(e){const t=e.toLowerCase();q.forEach(s=>{const n=s.querySelector(".faq-question span").textContent.toLowerCase(),o=s.querySelector(".faq-answer-content").textContent.toLowerCase();n.includes(t)||o.includes(t)?s.style.display="block":s.style.display=t===""?"block":"none"})}function Ie(e){q.forEach(t=>{e==="all"||t.dataset.category===e?t.style.display="block":t.style.display="none"})}I&&I.addEventListener("input",e=>{Le(e.target.value),e.target.value&&(S.forEach(t=>t.classList.remove("active")),S[0].classList.add("active"))});S.forEach(e=>{e.addEventListener("click",()=>{I&&(I.value=""),S.forEach(t=>t.classList.remove("active")),e.classList.add("active"),Ie(e.dataset.category)})});Ee.forEach(e=>{e.addEventListener("click",()=>{const t=e.closest(".faq-item"),s=t.classList.contains("active");q.forEach(n=>{n!==t&&n.classList.remove("active")}),t.classList.toggle("active",!s)})});const Z=new IntersectionObserver(e=>{e.forEach((t,s)=>{t.isIntersecting&&(setTimeout(()=>{t.target.style.opacity="1",t.target.style.transform="translateY(0) scale(1)"},s*100),Z.unobserve(t.target))})},{threshold:.1});G.forEach(e=>{e.style.opacity="0",e.style.transform="translateY(30px) scale(0.9)",e.style.transition="all 0.6s cubic-bezier(0.4, 0, 0.2, 1)",Z.observe(e)});const ee=new IntersectionObserver(e=>{e.forEach((t,s)=>{t.isIntersecting&&(setTimeout(()=>{t.target.style.opacity="1",t.target.style.transform="translateY(0)"},s*150),ee.unobserve(t.target))})},{threshold:.1});_.forEach(e=>{e.style.opacity="0",e.style.transform="translateY(40px)",e.style.transition="all 0.8s cubic-bezier(0.4, 0, 0.2, 1)",ee.observe(e)});const te=new IntersectionObserver(e=>{e.forEach((t,s)=>{t.isIntersecting&&(setTimeout(()=>{t.target.style.opacity="1",t.target.style.transform="translateX(0)"},s*100),te.unobserve(t.target))})},{threshold:.1});q.forEach(e=>{e.style.opacity="0",e.style.transform="translateX(-20px)",e.style.transition="all 0.6s cubic-bezier(0.4, 0, 0.2, 1)",te.observe(e)});const Se=document.querySelectorAll('a[href^="#"]');Se.forEach(e=>{e.getAttribute("href").startsWith("#slide")||e.addEventListener("click",function(t){t.preventDefault();const s=this.getAttribute("href"),n=document.querySelector(s);if(n){const o=n.offsetTop-80;window.scrollTo({top:o,behavior:"smooth"})}})});const ke=document.querySelectorAll(".gallery-item svg, .blog-image svg"),se=new IntersectionObserver(e=>{e.forEach(t=>{t.isIntersecting&&(t.target.style.opacity="1",se.unobserve(t.target))})});ke.forEach(e=>{e.style.opacity="0",e.style.transition="opacity 0.3s ease",se.observe(e)});console.log("🚀 New Custom Agency - Toutes les fonctionnalités premium chargées avec succès !");const xe=document.getElementById("chatbot-toggle"),qe=document.getElementById("chatbot-window"),C=document.getElementById("chatbot-messages"),k=document.getElementById("chat-input"),Ce=document.getElementById("chat-send"),ne=document.getElementById("chatbot-badge");let y=!1,r={devis:"Pour un devis personnalisé, je peux vous orienter vers notre calculateur automatique ou vous pouvez remplir notre formulaire de contact. Quel service vous intéresse ?",tracking:'Pour suivre votre colis, veuillez me communiquer votre numéro de suivi. Il commence généralement par "NCA" suivi de 8 chiffres.',services:`Nos services principaux sont :
• Dédouanement expert
• Transport multimodal
• Entreposage sécurisé
• Gestion hydrocarbures

Sur quoi puis-je vous renseigner ?`,contact:`Vous pouvez nous contacter :
📞 (+243) 82 126 41 88
📞 (+243) 84 45 47 797
📍 Avenue Kasavubu, 24 Lubumbashi
💬 WhatsApp disponible

Ou prendre RDV directement !`,tarifs:"Nos tarifs dépendent de plusieurs facteurs : poids, volume, destination, urgence. Utilisez notre calculateur pour une estimation immédiate !",delais:`Nos délais standard :
• Dédouanement : 24-48h
• Transport national : 2-5 jours
• Service express disponible

Voulez-vous plus de détails ?`,horaires:`Nos horaires :
🕒 Lun-Ven : 8h-17h
🕒 Samedi : 8h-12h
🚨 Support urgence : 24h/7j

Nous sommes actuellement en ligne !`,documents:`Documents requis :
📄 Facture commerciale
📄 Connaissement
📄 Liste de colisage
📄 Certificat d'origine

Besoin d'aide pour les préparer ?`};function z(){y=!y,qe.classList.toggle("active",y),y&&(k.focus(),ne.style.display="none")}function A(e,t=!1){const s=document.createElement("div");s.className=`chat-message ${t?"user":"bot"}`,t?s.innerHTML=`<div class="message-content">${e}</div>`:s.innerHTML=`
<div class="message-avatar">NCA</div>
<div class="message-content">${e.replace(/\n/g,"<br>")}</div>
`,C.appendChild(s),C.scrollTop=C.scrollHeight}function we(e){const t=e.toLowerCase();return t.includes("prix")||t.includes("tarif")||t.includes("coût")?r.tarifs:t.includes("suivi")||t.includes("tracking")||t.includes("colis")?r.tracking:t.includes("délai")||t.includes("temps")||t.includes("durée")?r.delais:t.includes("document")||t.includes("papier")||t.includes("certificat")?r.documents:t.includes("horaire")||t.includes("ouvert")||t.includes("fermé")?r.horaires:t.includes("service")||t.includes("prestation")?r.services:t.includes("contact")||t.includes("téléphone")||t.includes("adresse")?r.contact:t.includes("devis")||t.includes("estimation")||t.includes("calculer")?r.devis:t.includes("bonjour")||t.includes("salut")||t.includes("hello")?"👋 Bonjour ! Je suis ravi de vous aider. En quoi puis-je vous être utile aujourd'hui ?":t.includes("merci")||t.includes("thanks")?"😊 Je vous en prie ! N'hésitez pas si vous avez d'autres questions. Bonne journée !":`Je comprends votre question. Pour une réponse précise, je vous recommande de :
• Utiliser notre calculateur de devis
• Consulter notre FAQ
• Contacter directement nos experts

Que préférez-vous ?`}function oe(){const e=k.value.trim();e&&(A(e,!0),k.value="",setTimeout(()=>{const t=we(e);A(t)},1e3))}xe.addEventListener("click",z);Ce.addEventListener("click",oe);k.addEventListener("keypress",e=>{e.key==="Enter"&&oe()});document.addEventListener("click",e=>{if(e.target.classList.contains("suggestion-btn")){const t=e.target.dataset.suggestion;r[t]&&A(r[t])}});const Be=document.getElementById("whatsapp-btn");Be.addEventListener("click",()=>{const s=`https://wa.me/24382126418?text=${encodeURIComponent("Bonjour New Custom Agency ! Je souhaite obtenir des informations sur vos services logistiques.")}`;window.open(s,"_blank")});const O=document.getElementById("calculator-modal"),Te=document.getElementById("calculator-close"),h=document.querySelectorAll(".calc-step"),b=document.getElementById("calc-next"),ae=document.getElementById("calc-prev");let d=1,a={service:"",basePrice:0,weight:0,volume:0,origin:"",destination:"",options:[],extraCost:0};function D(){O.classList.add("active"),document.body.style.overflow="hidden"}function ce(){O.classList.remove("active"),document.body.style.overflow="",d=1,H(1)}function H(e){h.forEach((t,s)=>{t.classList.toggle("active",s+1===e)}),ae.style.display=e>1?"inline-flex":"none",b.textContent=e===h.length?"Calculer":"Suivant",e===h.length?(Ae(),b.style.display="none"):b.style.display="inline-flex"}function Ae(){let e=a.basePrice;const t=Math.max(a.weight*.5,0),s=Math.max(a.volume*10,0);let n=1;a.destination==="international"?n=2.5:a.origin!==a.destination&&(n=1.5),e=(e+t+s)*n+a.extraCost,document.getElementById("final-price").textContent=`${Math.round(e)} USD`}document.addEventListener("click",e=>{if(e.target.closest(".btn")&&e.target.textContent.includes("Calculer")&&D(),e.target.classList.contains("calc-option")){const t=d;if(t===1)document.querySelectorAll("#step-1 .calc-option").forEach(s=>s.classList.remove("selected")),e.target.classList.add("selected"),a.service=e.target.dataset.service,a.basePrice=parseInt(e.target.dataset.price);else if(t===3){e.target.classList.toggle("selected");const s=e.target.dataset.option,n=parseInt(e.target.dataset.extra);e.target.classList.contains("selected")?(a.options.push(s),a.extraCost+=n):(a.options=a.options.filter(o=>o!==s),a.extraCost-=n)}}});Te.addEventListener("click",ce);b.addEventListener("click",()=>{d<h.length&&(d===2&&(a.weight=parseFloat(document.getElementById("calc-weight").value)||0,a.volume=parseFloat(document.getElementById("calc-volume").value)||0,a.origin=document.getElementById("calc-origin").value,a.destination=document.getElementById("calc-destination").value),d++,H(d))});ae.addEventListener("click",()=>{d>1&&(d--,H(d))});const $=document.getElementById("rdv-modal"),De=document.getElementById("rdv-close"),E=document.querySelectorAll(".rdv-step"),L=document.getElementById("rdv-next"),ie=document.getElementById("rdv-prev");let u=1,c={type:"",date:"",time:"",name:"",email:"",phone:"",company:"",message:""};function Me(){$.classList.add("active"),document.body.style.overflow="hidden",Ne()}function R(){$.classList.remove("active"),document.body.style.overflow="",u=1,j(1)}function j(e){E.forEach((t,s)=>{t.classList.toggle("active",s+1===e)}),ie.style.display=e>1?"inline-flex":"none",e===E.length?(ze(),L.style.display="none"):(L.style.display="inline-flex",L.textContent=e===E.length-1?"Récapitulatif":"Suivant")}function Ne(){const e=document.getElementById("calendar-grid"),t=new Date,s=["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"];e.innerHTML="",s.forEach(n=>{const o=document.createElement("div");o.textContent=n,o.style.fontWeight="600",o.style.textAlign="center",o.style.padding="0.5rem",e.appendChild(o)});for(let n=1;n<=14;n++){const o=new Date(t);o.setDate(t.getDate()+n);const l=document.createElement("div");l.className="calendar-day",l.textContent=o.getDate(),l.dataset.date=o.toISOString().split("T")[0],o.getDay()===0||o.getDay()===6?l.classList.add("disabled"):l.addEventListener("click",()=>{document.querySelectorAll(".calendar-day").forEach(f=>f.classList.remove("selected")),l.classList.add("selected"),c.date=l.dataset.date}),e.appendChild(l)}}function ze(){const e=document.getElementById("rdv-summary"),s=new Date(c.date).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"});e.innerHTML=`
<div class="summary-item">
<span>Type de consultation :</span>
<span>${c.type}</span>
</div>
<div class="summary-item">
<span>Date :</span>
<span>${s}</span>
</div>
<div class="summary-item">
<span>Heure :</span>
<span>${c.time}</span>
</div>
<div class="summary-item">
<span>Contact :</span>
<span>${c.name} - ${c.email}</span>
</div>
`}document.addEventListener("click",e=>{e.target.closest(".btn")&&e.target.textContent.includes("Prendre rendez-vous")&&Me(),e.target.closest("[data-rdv-type]")&&(document.querySelectorAll("[data-rdv-type]").forEach(t=>t.classList.remove("selected")),e.target.closest("[data-rdv-type]").classList.add("selected"),c.type=e.target.closest("[data-rdv-type]").dataset.rdvType),e.target.classList.contains("time-slot")&&!e.target.classList.contains("unavailable")&&(document.querySelectorAll(".time-slot").forEach(t=>t.classList.remove("selected")),e.target.classList.add("selected"),c.time=e.target.dataset.time)});De.addEventListener("click",R);L.addEventListener("click",()=>{if(u<E.length){if(u===4&&(c.name=document.getElementById("rdv-name").value,c.email=document.getElementById("rdv-email").value,c.phone=document.getElementById("rdv-phone").value,c.company=document.getElementById("rdv-company").value,c.message=document.getElementById("rdv-message").value,!c.name||!c.email||!c.phone)){alert("Veuillez remplir tous les champs obligatoires");return}u++,j(u)}});ie.addEventListener("click",()=>{u>1&&(u--,j(u))});document.getElementById("confirm-rdv").addEventListener("click",()=>{alert("🎉 Rendez-vous confirmé ! Vous recevrez un email de confirmation sous peu."),R()});document.addEventListener("click",e=>{var t;(e.target.textContent.includes("Demander un devis")||(t=e.target.closest("button"))!=null&&t.textContent.includes("devis"))&&D(),e.target.textContent.includes("Demander un devis")&&e.target.classList.contains("suggestion-btn")&&(z(),setTimeout(()=>D(),500))});setTimeout(()=>{ne.style.display="flex"},3e3);document.addEventListener("keydown",e=>{e.key==="Escape"&&(O.classList.contains("active")&&ce(),$.classList.contains("active")&&R(),y&&z())});console.log("💬 Fonctionnalités Communication Client activées !");
